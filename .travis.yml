language: ruby
before_install:
- gem install asciidoctor tilt
script:
- git clone https://github.com/sethwoodworth/asciidoctor-htmlbook.git
- asciidoctor -a toc -b xhtml5 -d book -T ./asciidoctor-htmlbook/htmlbook-autogen/
  -d book Adventures-of-Huckleberry-Finn.asciidoc -o Adventures-of-Huckleberry-Finn.html
- git clone https://github.com/sethwoodworth/HTMLBook
- xsltproc -stringparam external.assets.list " " ./HTMLBook/htmlbook-xsl/epub.xsl
  Adventures-of-Huckleberry-Finn.html
- cp ./HTMLBook/stylesheets/epub/epub.css OEBPS
- cp cover.png OEBPS/cover.png
- zip -rX Adventures-of-Huckleberry-Finn.html mimetype
- zip -rX Adventures-of-Huckleberry-Finn.html OEBPS/ META-INF/
branches:
  only:
  - master
deploy:
  skip_cleanup: true
  provider: releases
  api_key:
    secure: Y8ezshJ11Klykn4kdiSIKL8n5Pyg/Vrp1BeGEBIvpiMuoeJHBC8KP06Q+6igo0JcYim//QqDsKN2C8quADD9uXTYkwdvlyb6PBopZYzaUskurZ8jBynUsdCSQLHkA/QuhQ7xefsKGKzdCnSNxZjZKV9Pfic3vvmf7J1UxpWCP7seCsR662NwJPa3zXNp7b+QOL/r2lROwa0cFJl33ONUwCKphq+4NCPPUNMGcDvAjD0Uk8WbPwUi9E28xVkp1uN+pJ3D50AyT3+hoHtJNE9yzHznmgP6DA4zSurTveOqxod0OFHEktiHE/9GnCjGjKh6YMaxB6RDraOwq3KIFekdBXiOhpH0TQO3h6UQ18eU+dyEONVSNX8lmFftqgrUPgP1WiDLSR/UqTr6Ovwsrkhyqc575rvVa1y+fUgVHXo3qZZf0LcloDgg4NP0IpaVV72hcOtBIUTFlKcNrsCRxL8iTjqzpLjMvfzAQuSPDnbCDw2EKLob2cRsn+sYH6WowMVEgNlRnv0PCzUigAKL4MGWdYWum7YYDxXblAI1wzicUFRbmS0u9saEQ54r2iXOHLIuuI++mOFuvkWUAeytNtGVtPGbFW1tCJi4J+lkYvUmIEA7/0Anor2GQ/ppZOyWgOSFojqc6sxqi7rPKykIg0TPWCPmOjlD9Bh8zdfVNjynEUg=
  file: Adventures-of-Huckleberry-Finn.html.epub
  on:
    repo: rdhyee/Adventures-of-Huckleberry-Finn_76
addons:
  apt:
    packages:
    - xsltproc
