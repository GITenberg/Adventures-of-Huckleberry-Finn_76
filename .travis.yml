language: ruby
before_install:
- gem install asciidoctor tilt
script:
- git clone https://github.com/sethwoodworth/asciidoctor-htmlbook.git
- asciidoctor -a toc -b xhtml5 -d book -T ./asciidoctor-htmlbook/htmlbook-autogen/
  -d book Adventures-of-Huckleberry-Finn.asciidoc -o Adventures-of-Huckleberry-Finn.html
- git clone https://github.com/sethwoodworth/HTMLBook
- xsltproc -stringparam external.assets.list " " ./HTMLBook/htmlbook-xsl/epub.xsl
  Adventures-of-Huckleberry-Finn.html
- cp ./HTMLBook/stylesheets/epub/epub.css OEBPS
- cp cover.png OEBPS/cover.png
- mv ./images ./OEBPS/
- zip -rX Adventures-of-Huckleberry-Finn.epub mimetype
- zip -rX Adventures-of-Huckleberry-Finn.epub OEBPS/ META-INF/
- zip -rX Adventures-of-Huckleberry-Finn.epub OEBPS/images/
branches:
  only:
  - master
deploy:
  skip_cleanup: true
  provider: releases
  api_key:
    secure: YnvCUm6XS+U12gRYuBGpWQVXt6teV6UgyI1/UHP6KF8x4VMB4YBoGk4z5xZISDGJuyYKUMVCTrdJKLBzke3jM+/oxjwRSHIzeslg2V73PxNeEYOip7WHd6YECKF8YbqgmV1+lo5HlqPJhtBzumJqgOXRUY/LwHtR/qh6p8HV7CGnGkfX1kHvSDzwrnWpQB9AJ3sUIfO92RPxmwcpu9b832dthg2bFkwt4Ij3LcsXGdcV59KQzrEvwvx51TlfEBaZrxwTn8MfhN3ZDmljxg1ghy6H16MTiZTV4/6g9RlYmzBzA/uYQ5oKOv+Y1Fl3RdNOlFYTBqhK24zQtNq0RpdJppd3O0sJZacJL18iIb8coaURIxMvJ3hSXT5t5ubpuFAulM0vxSHJN+YVyJpMm9nOTOguJGrTZb3ekYp+9j1zacACIPgVU1/IpJjJvErgLNhQRDa/PBDtE3QllGYFW1nPgd86/wjhZM3DJNUWUtmYBLzhX5A+Oc5M1jq2Upkpiq+biuZ9LscdA0Lz1clDtNqIvjHPwITFzVpp/pQsVADBTM3HRbRMtmKUxf4K7uZaBwGH2vsbJupeS6wgsZB0kwbcJQSCUvSAPysJWFsw+9ouyLYNBqmUs9ZbweNeX5vvGFUVJ6fIqrb4WnRhfZZE64jOwbx35+XhrLn1so03z9q6vfI=
  file: Adventures-of-Huckleberry-Finn.epub
  on:
    repo: GITenberg/Adventures-of-Huckleberry-Finn_76
addons:
  apt:
    packages:
    - xsltproc
